import{r,G as A,j as a,c as Et,a as Rt,u as Ue,g as bt,A as wt}from"./index-CsJGC5FH.js";import{c as ne,o as Ne,s as te,g as Nt,R as kt,l as Ae,i as Tt,u as v,a as y,b as be,C as Ft,d as Mt,e as St,f as Ot,r as Ie,F as ze,h as $t,t as Bt,P as q,j as qe,k as Xe}from"./CloseButton-D_rpZJHE.js";function Lt(){const{selectedChannel:e}=r.useContext(A);return a.jsxs("div",{className:"card-header bg-primary-subtle text-white text-center",children:[a.jsx("div",{className:"d-flex justify-content-between align-items-center",children:a.jsx("h1",{className:"flex-grow-1",children:"Fidechat"})}),e&&a.jsx("h5",{className:"mt-2",children:e.description})]})}var ue;function De(e){if((!ue&&ue!==0||e)&&ne){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),ue=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return ue}function At(){return r.useState(null)}function ve(e){e===void 0&&(e=Ne());try{var t=e.activeElement;return!t||!t.nodeName?null:t}catch{return e.body}}function We(e,t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return e===t||!!(e.compareDocumentPosition(t)&16)}function It(){const e=r.useRef(!0),t=r.useRef(()=>e.current);return r.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function Dt(e){const t=r.useRef(e);return t.current=e,t}function Wt(e){const t=Dt(e);r.useEffect(()=>()=>t.current(),[])}function _t(e){const t=r.useRef(null);return r.useEffect(()=>{t.current=e}),t.current}function Ht(e){const t=r.useRef(e);return r.useEffect(()=>{t.current=e},[e]),t}function L(e){const t=Ht(e);return r.useCallback(function(...n){return t.current&&t.current(...n)},[t])}const Vt="data-rr-ui-";function Gt(e){return`${Vt}${e}`}function Kt(e=document){const t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}const _e=Gt("modal-open");class ke{constructor({ownerDocument:t,handleContainerOverflow:n=!0,isRTL:o=!1}={}){this.handleContainerOverflow=n,this.isRTL=o,this.modals=[],this.ownerDocument=t}getScrollbarWidth(){return Kt(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(t){}removeModalAttributes(t){}setContainerStyle(t){const n={overflow:"hidden"},o=this.isRTL?"paddingLeft":"paddingRight",s=this.getElement();t.style={overflow:s.style.overflow,[o]:s.style[o]},t.scrollBarWidth&&(n[o]=`${parseInt(te(s,o)||"0",10)+t.scrollBarWidth}px`),s.setAttribute(_e,""),te(s,n)}reset(){[...this.modals].forEach(t=>this.remove(t))}removeContainerStyle(t){const n=this.getElement();n.removeAttribute(_e),Object.assign(n.style,t.style)}add(t){let n=this.modals.indexOf(t);return n!==-1||(n=this.modals.length,this.modals.push(t),this.setModalAttributes(t),n!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),n}remove(t){const n=this.modals.indexOf(t);n!==-1&&(this.modals.splice(n,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(t))}isTopModal(t){return!!this.modals.length&&this.modals[this.modals.length-1]===t}}const Ye=r.createContext(ne?window:void 0);Ye.Provider;function Te(){return r.useContext(Ye)}const je=(e,t)=>ne?e==null?(t||Ne()).body:(typeof e=="function"&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;function Ut(e,t){const n=Te(),[o,s]=r.useState(()=>je(e,n==null?void 0:n.document));if(!o){const l=je(e);l&&s(l)}return r.useEffect(()=>{},[t,o]),r.useEffect(()=>{const l=je(e);l!==o&&s(l)},[e,o]),o}const He=e=>!e||typeof e=="function"?e:t=>{e.current=t};function zt(e,t){const n=He(e),o=He(t);return s=>{n&&n(s),o&&o(s)}}function Fe(e,t){return r.useMemo(()=>zt(e,t),[e,t])}const qt=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",Xt=typeof document<"u",Ve=Xt||qt?r.useLayoutEffect:r.useEffect;function Yt({children:e,in:t,onExited:n,mountOnEnter:o,unmountOnExit:s}){const l=r.useRef(null),i=r.useRef(t),u=L(n);r.useEffect(()=>{t?i.current=!0:u(l.current)},[t,u]);const f=Fe(l,e.ref),d=r.cloneElement(e,{ref:f});return t?d:s||!i.current&&o?null:d}const Jt=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function Qt(e,t){if(e==null)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function Zt(e){let{onEnter:t,onEntering:n,onEntered:o,onExit:s,onExiting:l,onExited:i,addEndListener:u,children:f}=e,d=Qt(e,Jt);const m=r.useRef(null),h=Fe(m,Nt(f)),c=R=>k=>{R&&m.current&&R(m.current,k)},p=r.useCallback(c(t),[t]),C=r.useCallback(c(n),[n]),E=r.useCallback(c(o),[o]),N=r.useCallback(c(s),[s]),b=r.useCallback(c(l),[l]),$=r.useCallback(c(i),[i]),M=r.useCallback(c(u),[u]);return Object.assign({},d,{nodeRef:m},t&&{onEnter:p},n&&{onEntering:C},o&&{onEntered:E},s&&{onExit:N},l&&{onExiting:b},i&&{onExited:$},u&&{addEndListener:M},{children:typeof f=="function"?(R,k)=>f(R,Object.assign({},k,{ref:h})):r.cloneElement(f,{ref:h})})}const Pt=["component"];function en(e,t){if(e==null)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}const tn=r.forwardRef((e,t)=>{let{component:n}=e,o=en(e,Pt);const s=Zt(o);return a.jsx(n,Object.assign({ref:t},s))});function nn({in:e,onTransition:t}){const n=r.useRef(null),o=r.useRef(!0),s=L(t);return Ve(()=>{if(!n.current)return;let l=!1;return s({in:e,element:n.current,initial:o.current,isStale:()=>l}),()=>{l=!0}},[e,s]),Ve(()=>(o.current=!1,()=>{o.current=!0}),[]),n}function on({children:e,in:t,onExited:n,onEntered:o,transition:s}){const[l,i]=r.useState(!t);t&&l&&i(!1);const u=nn({in:!!t,onTransition:d=>{const m=()=>{d.isStale()||(d.in?o==null||o(d.element,d.initial):(i(!0),n==null||n(d.element)))};Promise.resolve(s(d)).then(m,h=>{throw d.in||i(!0),h})}}),f=Fe(u,e.ref);return l&&!t?null:r.cloneElement(e,{ref:f})}function Ge(e,t,n){return e?a.jsx(tn,Object.assign({},n,{component:e})):t?a.jsx(on,Object.assign({},n,{transition:t})):a.jsx(Yt,Object.assign({},n))}const sn=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function rn(e,t){if(e==null)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}let Ee;function an(e){return Ee||(Ee=new ke({ownerDocument:e==null?void 0:e.document})),Ee}function ln(e){const t=Te(),n=e||an(t),o=r.useRef({dialog:null,backdrop:null});return Object.assign(o.current,{add:()=>n.add(o.current),remove:()=>n.remove(o.current),isTopModal:()=>n.isTopModal(o.current),setDialogRef:r.useCallback(s=>{o.current.dialog=s},[]),setBackdropRef:r.useCallback(s=>{o.current.backdrop=s},[])})}const Je=r.forwardRef((e,t)=>{let{show:n=!1,role:o="dialog",className:s,style:l,children:i,backdrop:u=!0,keyboard:f=!0,onBackdropClick:d,onEscapeKeyDown:m,transition:h,runTransition:c,backdropTransition:p,runBackdropTransition:C,autoFocus:E=!0,enforceFocus:N=!0,restoreFocus:b=!0,restoreFocusOptions:$,renderDialog:M,renderBackdrop:R=x=>a.jsx("div",Object.assign({},x)),manager:k,container:I,onShow:D,onHide:X=()=>{},onExit:pe,onExited:Y,onExiting:oe,onEnter:se,onEntering:re,onEntered:ae}=e,ge=rn(e,sn);const S=Te(),W=Ut(I),j=ln(k),ye=It(),le=_t(n),[B,_]=r.useState(!n),w=r.useRef(null);r.useImperativeHandle(t,()=>j,[j]),ne&&!le&&n&&(w.current=ve(S==null?void 0:S.document)),n&&B&&_(!1);const O=L(()=>{if(j.add(),H.current=Ae(document,"keydown",Ce),Q.current=Ae(document,"focus",()=>setTimeout(xe),!0),D&&D(),E){var x,de;const P=ve((x=(de=j.dialog)==null?void 0:de.ownerDocument)!=null?x:S==null?void 0:S.document);j.dialog&&P&&!We(j.dialog,P)&&(w.current=P,j.dialog.focus())}}),J=L(()=>{if(j.remove(),H.current==null||H.current(),Q.current==null||Q.current(),b){var x;(x=w.current)==null||x.focus==null||x.focus($),w.current=null}});r.useEffect(()=>{!n||!W||O()},[n,W,O]),r.useEffect(()=>{B&&J()},[B,J]),Wt(()=>{J()});const xe=L(()=>{if(!N||!ye()||!j.isTopModal())return;const x=ve(S==null?void 0:S.document);j.dialog&&x&&!We(j.dialog,x)&&j.dialog.focus()}),ie=L(x=>{x.target===x.currentTarget&&(d==null||d(x),u===!0&&X())}),Ce=L(x=>{f&&Tt(x)&&j.isTopModal()&&(m==null||m(x),x.defaultPrevented||X())}),Q=r.useRef(),H=r.useRef(),ce=(...x)=>{_(!0),Y==null||Y(...x)};if(!W)return null;const V=Object.assign({role:o,ref:j.setDialogRef,"aria-modal":o==="dialog"?!0:void 0},ge,{style:l,className:s,tabIndex:-1});let Z=M?M(V):a.jsx("div",Object.assign({},V,{children:r.cloneElement(i,{role:"document"})}));Z=Ge(h,c,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:pe,onExiting:oe,onExited:ce,onEnter:se,onEntering:re,onEntered:ae,children:Z});let G=null;return u&&(G=R({ref:j.setBackdropRef,onClick:ie}),G=Ge(p,C,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:G})),a.jsx(a.Fragment,{children:kt.createPortal(a.jsxs(a.Fragment,{children:[G,Z]}),W)})});Je.displayName="Modal";const cn=Object.assign(Je,{Manager:ke});function dn(e,t){return e.classList?e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}function un(e,t){e.classList?e.classList.add(t):dn(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}var fn=Function.prototype.bind.call(Function.prototype.call,[].slice);function U(e,t){return fn(e.querySelectorAll(t))}function Ke(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function mn(e,t){e.classList?e.classList.remove(t):typeof e.className=="string"?e.className=Ke(e.className,t):e.setAttribute("class",Ke(e.className&&e.className.baseVal||"",t))}const z={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class hn extends ke{adjustAndStore(t,n,o){const s=n.style[t];n.dataset[t]=s,te(n,{[t]:`${parseFloat(te(n,t))+o}px`})}restore(t,n){const o=n.dataset[t];o!==void 0&&(delete n.dataset[t],te(n,{[t]:o}))}setContainerStyle(t){super.setContainerStyle(t);const n=this.getElement();if(un(n,"modal-open"),!t.scrollBarWidth)return;const o=this.isRTL?"paddingLeft":"paddingRight",s=this.isRTL?"marginLeft":"marginRight";U(n,z.FIXED_CONTENT).forEach(l=>this.adjustAndStore(o,l,t.scrollBarWidth)),U(n,z.STICKY_CONTENT).forEach(l=>this.adjustAndStore(s,l,-t.scrollBarWidth)),U(n,z.NAVBAR_TOGGLER).forEach(l=>this.adjustAndStore(s,l,t.scrollBarWidth))}removeContainerStyle(t){super.removeContainerStyle(t);const n=this.getElement();mn(n,"modal-open");const o=this.isRTL?"paddingLeft":"paddingRight",s=this.isRTL?"marginLeft":"marginRight";U(n,z.FIXED_CONTENT).forEach(l=>this.restore(o,l)),U(n,z.STICKY_CONTENT).forEach(l=>this.restore(s,l)),U(n,z.NAVBAR_TOGGLER).forEach(l=>this.restore(s,l))}}let Re;function pn(e){return Re||(Re=new hn(e)),Re}const Qe=r.forwardRef(({className:e,bsPrefix:t,as:n="div",...o},s)=>(t=v(t,"modal-body"),a.jsx(n,{ref:s,className:y(e,t),...o})));Qe.displayName="ModalBody";const Ze=r.createContext({onHide(){}}),Me=r.forwardRef(({bsPrefix:e,className:t,contentClassName:n,centered:o,size:s,fullscreen:l,children:i,scrollable:u,...f},d)=>{e=v(e,"modal");const m=`${e}-dialog`,h=typeof l=="string"?`${e}-fullscreen-${l}`:`${e}-fullscreen`;return a.jsx("div",{...f,ref:d,className:y(m,t,s&&`${e}-${s}`,o&&`${m}-centered`,u&&`${m}-scrollable`,l&&h),children:a.jsx("div",{className:y(`${e}-content`,n),children:i})})});Me.displayName="ModalDialog";const Pe=r.forwardRef(({className:e,bsPrefix:t,as:n="div",...o},s)=>(t=v(t,"modal-footer"),a.jsx(n,{ref:s,className:y(e,t),...o})));Pe.displayName="ModalFooter";const gn=r.forwardRef(({closeLabel:e="Close",closeVariant:t,closeButton:n=!1,onHide:o,children:s,...l},i)=>{const u=r.useContext(Ze),f=be(()=>{u==null||u.onHide(),o==null||o()});return a.jsxs("div",{ref:i,...l,children:[s,n&&a.jsx(Ft,{"aria-label":e,variant:t,onClick:f})]})}),et=r.forwardRef(({bsPrefix:e,className:t,closeLabel:n="Close",closeButton:o=!1,...s},l)=>(e=v(e,"modal-header"),a.jsx(gn,{ref:l,...s,className:y(t,e),closeLabel:n,closeButton:o})));et.displayName="ModalHeader";const yn=e=>r.forwardRef((t,n)=>a.jsx("div",{...t,ref:n,className:y(t.className,e)})),xn=yn("h4"),tt=r.forwardRef(({className:e,bsPrefix:t,as:n=xn,...o},s)=>(t=v(t,"modal-title"),a.jsx(n,{ref:s,className:y(e,t),...o})));tt.displayName="ModalTitle";function Cn(e){return a.jsx(ze,{...e,timeout:null})}function vn(e){return a.jsx(ze,{...e,timeout:null})}const nt=r.forwardRef(({bsPrefix:e,className:t,style:n,dialogClassName:o,contentClassName:s,children:l,dialogAs:i=Me,"data-bs-theme":u,"aria-labelledby":f,"aria-describedby":d,"aria-label":m,show:h=!1,animation:c=!0,backdrop:p=!0,keyboard:C=!0,onEscapeKeyDown:E,onShow:N,onHide:b,container:$,autoFocus:M=!0,enforceFocus:R=!0,restoreFocus:k=!0,restoreFocusOptions:I,onEntered:D,onExit:X,onExiting:pe,onEnter:Y,onEntering:oe,onExited:se,backdropClassName:re,manager:ae,...ge},S)=>{const[W,j]=r.useState({}),[ye,le]=r.useState(!1),B=r.useRef(!1),_=r.useRef(!1),w=r.useRef(null),[O,J]=At(),xe=Mt(S,J),ie=be(b),Ce=St();e=v(e,"modal");const Q=r.useMemo(()=>({onHide:ie}),[ie]);function H(){return ae||pn({isRTL:Ce})}function ce(g){if(!ne)return;const K=H().getScrollbarWidth()>0,Le=g.scrollHeight>Ne(g).documentElement.clientHeight;j({paddingRight:K&&!Le?De():void 0,paddingLeft:!K&&Le?De():void 0})}const V=be(()=>{O&&ce(O.dialog)});Ot(()=>{Ie(window,"resize",V),w.current==null||w.current()});const Z=()=>{B.current=!0},G=g=>{B.current&&O&&g.target===O.dialog&&(_.current=!0),B.current=!1},x=()=>{le(!0),w.current=Bt(O.dialog,()=>{le(!1)})},de=g=>{g.target===g.currentTarget&&x()},P=g=>{if(p==="static"){de(g);return}if(_.current||g.target!==g.currentTarget){_.current=!1;return}b==null||b()},pt=g=>{C?E==null||E(g):(g.preventDefault(),p==="static"&&x())},gt=(g,K)=>{g&&ce(g),Y==null||Y(g,K)},yt=g=>{w.current==null||w.current(),X==null||X(g)},xt=(g,K)=>{oe==null||oe(g,K),$t(window,"resize",V)},Ct=g=>{g&&(g.style.display=""),se==null||se(g),Ie(window,"resize",V)},vt=r.useCallback(g=>a.jsx("div",{...g,className:y(`${e}-backdrop`,re,!c&&"show")}),[c,re,e]),Be={...n,...W};Be.display="block";const jt=g=>a.jsx("div",{role:"dialog",...g,style:Be,className:y(t,e,ye&&`${e}-static`,!c&&"show"),onClick:p?P:void 0,onMouseUp:G,"data-bs-theme":u,"aria-label":m,"aria-labelledby":f,"aria-describedby":d,children:a.jsx(i,{...ge,onMouseDown:Z,className:o,contentClassName:s,children:l})});return a.jsx(Ze.Provider,{value:Q,children:a.jsx(cn,{show:h,ref:xe,backdrop:p,container:$,keyboard:!0,autoFocus:M,enforceFocus:R,restoreFocus:k,restoreFocusOptions:I,onEscapeKeyDown:pt,onShow:N,onHide:b,onEnter:gt,onEntering:xt,onEntered:D,onExit:yt,onExiting:pe,onExited:Ct,manager:H(),transition:c?Cn:void 0,backdropTransition:c?vn:void 0,renderBackdrop:vt,renderDialog:jt})})});nt.displayName="Modal";const ee=Object.assign(nt,{Body:Qe,Header:et,Title:tt,Footer:Pe,Dialog:Me,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),jn=["as","disabled"];function En(e,t){if(e==null)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}function Rn(e){return!e||e.trim()==="#"}function ot({tagName:e,disabled:t,href:n,target:o,rel:s,role:l,onClick:i,tabIndex:u=0,type:f}){e||(n!=null||o!=null||s!=null?e="a":e="button");const d={tagName:e};if(e==="button")return[{type:f||"button",disabled:t},d];const m=c=>{if((t||e==="a"&&Rn(n))&&c.preventDefault(),t){c.stopPropagation();return}i==null||i(c)},h=c=>{c.key===" "&&(c.preventDefault(),m(c))};return e==="a"&&(n||(n="#"),t&&(n=void 0)),[{role:l??"button",disabled:void 0,tabIndex:t?void 0:u,href:n,target:e==="a"?o:void 0,"aria-disabled":t||void 0,rel:e==="a"?s:void 0,onClick:m,onKeyDown:h},d]}const bn=r.forwardRef((e,t)=>{let{as:n,disabled:o}=e,s=En(e,jn);const[l,{tagName:i}]=ot(Object.assign({tagName:n,disabled:o},s));return a.jsx(i,Object.assign({},s,l,{ref:t}))});bn.displayName="Button";const we=r.forwardRef(({as:e,bsPrefix:t,variant:n="primary",size:o,active:s=!1,disabled:l=!1,className:i,...u},f)=>{const d=v(t,"btn"),[m,{tagName:h}]=ot({tagName:e,disabled:l,...u}),c=h;return a.jsx(c,{...m,...u,ref:f,disabled:l,className:y(i,d,s&&"active",n&&`${d}-${n}`,o&&`${d}-${o}`,u.href&&l&&"disabled")})});we.displayName="Button";const wn={type:q.string,tooltip:q.bool,as:q.elementType},he=r.forwardRef(({as:e="div",className:t,type:n="valid",tooltip:o=!1,...s},l)=>a.jsx(e,{...s,ref:l,className:y(t,`${n}-${o?"tooltip":"feedback"}`)}));he.displayName="Feedback";he.propTypes=wn;const F=r.createContext({}),Se=r.forwardRef(({id:e,bsPrefix:t,className:n,type:o="checkbox",isValid:s=!1,isInvalid:l=!1,as:i="input",...u},f)=>{const{controlId:d}=r.useContext(F);return t=v(t,"form-check-input"),a.jsx(i,{...u,ref:f,type:o,id:e||d,className:y(n,t,s&&"is-valid",l&&"is-invalid")})});Se.displayName="FormCheckInput";const fe=r.forwardRef(({bsPrefix:e,className:t,htmlFor:n,...o},s)=>{const{controlId:l}=r.useContext(F);return e=v(e,"form-check-label"),a.jsx("label",{...o,ref:s,htmlFor:n||l,className:y(t,e)})});fe.displayName="FormCheckLabel";function Nn(e,t){return r.Children.toArray(e).some(n=>r.isValidElement(n)&&n.type===t)}const st=r.forwardRef(({id:e,bsPrefix:t,bsSwitchPrefix:n,inline:o=!1,reverse:s=!1,disabled:l=!1,isValid:i=!1,isInvalid:u=!1,feedbackTooltip:f=!1,feedback:d,feedbackType:m,className:h,style:c,title:p="",type:C="checkbox",label:E,children:N,as:b="input",...$},M)=>{t=v(t,"form-check"),n=v(n,"form-switch");const{controlId:R}=r.useContext(F),k=r.useMemo(()=>({controlId:e||R}),[R,e]),I=!N&&E!=null&&E!==!1||Nn(N,fe),D=a.jsx(Se,{...$,type:C==="switch"?"checkbox":C,ref:M,isValid:i,isInvalid:u,disabled:l,as:b});return a.jsx(F.Provider,{value:k,children:a.jsx("div",{style:c,className:y(h,I&&t,o&&`${t}-inline`,s&&`${t}-reverse`,C==="switch"&&n),children:N||a.jsxs(a.Fragment,{children:[D,I&&a.jsx(fe,{title:p,children:E}),d&&a.jsx(he,{type:m,tooltip:f,children:d})]})})})});st.displayName="FormCheck";const me=Object.assign(st,{Input:Se,Label:fe}),rt=r.forwardRef(({bsPrefix:e,type:t,size:n,htmlSize:o,id:s,className:l,isValid:i=!1,isInvalid:u=!1,plaintext:f,readOnly:d,as:m="input",...h},c)=>{const{controlId:p}=r.useContext(F);return e=v(e,"form-control"),a.jsx(m,{...h,type:t,size:o,ref:c,readOnly:d,id:s||p,className:y(l,f?`${e}-plaintext`:e,n&&`${e}-${n}`,t==="color"&&`${e}-color`,i&&"is-valid",u&&"is-invalid")})});rt.displayName="FormControl";const kn=Object.assign(rt,{Feedback:he}),at=r.forwardRef(({className:e,bsPrefix:t,as:n="div",...o},s)=>(t=v(t,"form-floating"),a.jsx(n,{ref:s,className:y(e,t),...o})));at.displayName="FormFloating";const Oe=r.forwardRef(({controlId:e,as:t="div",...n},o)=>{const s=r.useMemo(()=>({controlId:e}),[e]);return a.jsx(F.Provider,{value:s,children:a.jsx(t,{...n,ref:o})})});Oe.displayName="FormGroup";function Tn({as:e,bsPrefix:t,className:n,...o}){t=v(t,"col");const s=qe(),l=Xe(),i=[],u=[];return s.forEach(f=>{const d=o[f];delete o[f];let m,h,c;typeof d=="object"&&d!=null?{span:m,offset:h,order:c}=d:m=d;const p=f!==l?`-${f}`:"";m&&i.push(m===!0?`${t}${p}`:`${t}${p}-${m}`),c!=null&&u.push(`order${p}-${c}`),h!=null&&u.push(`offset${p}-${h}`)}),[{...o,className:y(n,...i,...u)},{as:e,bsPrefix:t,spans:i}]}const lt=r.forwardRef((e,t)=>{const[{className:n,...o},{as:s="div",bsPrefix:l,spans:i}]=Tn(e);return a.jsx(s,{...o,ref:t,className:y(n,!i.length&&l)})});lt.displayName="Col";const it=r.forwardRef(({as:e="label",bsPrefix:t,column:n=!1,visuallyHidden:o=!1,className:s,htmlFor:l,...i},u)=>{const{controlId:f}=r.useContext(F);t=v(t,"form-label");let d="col-form-label";typeof n=="string"&&(d=`${d} ${d}-${n}`);const m=y(s,t,o&&"visually-hidden",n&&d);return l=l||f,n?a.jsx(lt,{ref:u,as:"label",className:m,htmlFor:l,...i}):a.jsx(e,{ref:u,className:m,htmlFor:l,...i})});it.displayName="FormLabel";const ct=r.forwardRef(({bsPrefix:e,className:t,id:n,...o},s)=>{const{controlId:l}=r.useContext(F);return e=v(e,"form-range"),a.jsx("input",{...o,type:"range",ref:s,className:y(t,e),id:n||l})});ct.displayName="FormRange";const dt=r.forwardRef(({bsPrefix:e,size:t,htmlSize:n,className:o,isValid:s=!1,isInvalid:l=!1,id:i,...u},f)=>{const{controlId:d}=r.useContext(F);return e=v(e,"form-select"),a.jsx("select",{...u,size:n,ref:f,className:y(o,e,t&&`${e}-${t}`,s&&"is-valid",l&&"is-invalid"),id:i||d})});dt.displayName="FormSelect";const ut=r.forwardRef(({bsPrefix:e,className:t,as:n="small",muted:o,...s},l)=>(e=v(e,"form-text"),a.jsx(n,{...s,ref:l,className:y(t,e,o&&"text-muted")})));ut.displayName="FormText";const ft=r.forwardRef((e,t)=>a.jsx(me,{...e,ref:t,type:"switch"}));ft.displayName="Switch";const Fn=Object.assign(ft,{Input:me.Input,Label:me.Label}),mt=r.forwardRef(({bsPrefix:e,className:t,children:n,controlId:o,label:s,...l},i)=>(e=v(e,"form-floating"),a.jsxs(Oe,{ref:i,className:y(t,e),controlId:o,...l,children:[n,a.jsx("label",{htmlFor:o,children:s})]})));mt.displayName="FloatingLabel";const Mn={_ref:q.any,validated:q.bool,as:q.elementType},$e=r.forwardRef(({className:e,validated:t,as:n="form",...o},s)=>a.jsx(n,{...o,ref:s,className:y(e,t&&"was-validated")}));$e.displayName="Form";$e.propTypes=Mn;const T=Object.assign($e,{Group:Oe,Control:kn,Floating:at,Check:me,Switch:Fn,Label:it,Text:ut,Range:ct,Select:dt,FloatingLabel:mt}),ht=r.forwardRef(({bsPrefix:e,className:t,as:n="div",...o},s)=>{const l=v(e,"row"),i=qe(),u=Xe(),f=`${l}-cols`,d=[];return i.forEach(m=>{const h=o[m];delete o[m];let c;h!=null&&typeof h=="object"?{cols:c}=h:c=h;const p=m!==u?`-${m}`:"";c!=null&&d.push(`${f}${p}-${c}`)}),a.jsx(n,{ref:s,...o,className:y(t,l,...d)})});ht.displayName="Row";function Sn({show:e,handleClose:t}){const[n,o]=r.useState(!1),[s,l]=r.useState(""),[i,u]=r.useState(""),{currentUser:f}=r.useContext(A);function d(h,c){Et({name:h,description:c,ownerId:f.id})}const m=h=>{h.preventDefault();const c=h.currentTarget;console.log(c.checkValidity()),c.checkValidity()===!1?(h.stopPropagation(),o(!0)):(d(s,i),t(),l(""),u(""))};return a.jsxs(ee,{show:e,onHide:t,children:[a.jsx(ee.Header,{closeButton:!0,children:a.jsx(ee.Title,{children:"Create Channel"})}),a.jsx(ee.Body,{children:a.jsx(T,{id:"createChannelForm",noValidate:!0,validated:n,onSubmit:m,children:a.jsxs(ht,{className:"mb-3",children:[a.jsxs(T.Group,{controlId:"channelName",children:[a.jsx(T.Label,{children:"Channel Name"}),a.jsx(T.Control,{type:"text",value:s,onChange:h=>l(h.target.value),required:!0}),a.jsx(T.Control.Feedback,{type:"invalid",children:"Please provide a valid channel name."})]}),a.jsxs(T.Group,{controlId:"channelDescription",children:[a.jsx(T.Label,{children:"Description"}),a.jsx(T.Control,{required:!0,as:"textarea",value:i,onChange:h=>u(h.target.value)}),a.jsx(T.Control.Feedback,{type:"invalid",children:"Please provide a valid description."})]})]})})}),a.jsxs(ee.Footer,{children:[a.jsx(we,{variant:"secondary",onClick:t,children:"Close"}),a.jsx(we,{variant:"primary",type:"submit",form:"createChannelForm",children:"Create Channel"})]})]})}function On(){console.log("Sidebar rendered");const[e,t]=r.useState(!1),{currentUser:n,setSelectedChannel:o,selectedChannel:s,channels:l}=r.useContext(A);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-dark text-white d-flex flex-column p-3 flex-shrink-0 sidebar",style:{width:"250px"},children:[a.jsx("h5",{children:"Channels"}),a.jsx("ul",{className:"list-unstyled flex-grow-1",children:l.map((i,u)=>a.jsx("li",{className:"mb-2",children:a.jsx("button",{className:`p-2 w-100 text-left ${(s==null?void 0:s.id)===i.id?"bg-primary":"bg-dark-subtle"}`,onClick:()=>{(s==null?void 0:s.id)===i.id?o(null):o(i)},onKeyUp:f=>{(f.key==="Enter"||f.key===" ")&&o(i)},children:i.name})},u))}),a.jsx("button",{className:"btn btn-secondary mb-3",onClick:()=>t(!0),children:"Create Channel"}),a.jsxs("div",{className:"mt-auto",children:[a.jsx("hr",{className:"bg-light"}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"mb-1",children:n==null?void 0:n.name}),a.jsx("small",{className:"text-muted",children:n==null?void 0:n.email})]})]})]}),a.jsx(Sn,{show:e,handleClose:()=>t(!1)})]})}function $n({id:e,content:t,authorId:n}){const{users:o,currentUser:s}=r.useContext(A);let l="";if((s==null?void 0:s.id)===n)l="You";else{const i=o.find(u=>u.id===n);l=i?i.name:"Unknown"}return a.jsxs("div",{className:"mb-3 p-2 bg-body-tertiary rounded shadow-sm",children:[a.jsx("div",{className:"fw-bold",children:l}),a.jsx("div",{children:t})]},e)}function Bn(){console.log("Chat rendered");const[e,t]=r.useState(""),{selectedChannel:n,currentUser:o}=r.useContext(A),s=async()=>{if(e.length)try{const i={content:e,channelId:n.id,authorId:o.id};Rt(i),t("")}catch(i){console.error(i)}},l=i=>{i.key==="Enter"&&s()};return a.jsxs("div",{className:"card-body d-flex flex-column p-0",children:[a.jsx("div",{className:"flex-grow-1 overflow-auto p-3 bg-dark",children:n==null?void 0:n.messages.filter(i=>i.channelId===(n==null?void 0:n.id)).map(i=>a.jsx($n,{id:i.id,content:i.content,authorId:i.authorId},i.id))}),a.jsxs("div",{className:"card-footer d-flex p-3 bg-body-tertiary border-top",children:[a.jsx("input",{type:"text",className:"form-control me-2",value:e,onChange:i=>t(i.target.value),placeholder:"Type a message...",onKeyDown:l}),a.jsx("button",{className:"btn btn-primary",onClick:s,children:"Send"})]})]})}function Ln({isAuthenticated:e}){const[t,n]=r.useState(null),o=Ue(),{setChannels:s,setSelectedChannel:l,channels:i,selectedChannel:u}=r.useContext(A),f=r.useRef(i),d=r.useRef(u);r.useEffect(()=>{f.current=i,d.current=u},[i,u]);const m=h=>{var p;console.log(f.current),console.log("Received message:",h.data);const c=JSON.parse(h.data);if(c.type==="MESSAGE_CREATE"){const C=f.current.find(E=>E.id==c.payload.channelId);if(!C){console.error("Channel not found: "+c.payload.channelId);return}s(f.current.map(E=>E.id===C.id?{...C,messages:[...C.messages,c.payload]}:E)),((p=d.current)==null?void 0:p.id)===C.id&&l({...C,messages:[...C.messages,c.payload]})}else c.type==="CHANNEL_CREATE"&&s([...f.current,{...c.payload,messages:[]}])};return r.useEffect(()=>{if(!e){t&&(t.close(),n(null));return}const c=(async()=>{try{const p=await bt();if(!p)return;if(t)return console.error("Websocket connection already exists"),t;const C=new WebSocket("ws://localhost:8080/ws?token="+p);return C.onopen=()=>console.log("Connected to websocket"),C.onmessage=m,C.onclose=()=>console.log("Disconnected from websocket"),C}catch(p){console.error(p),p instanceof wt&&p.isUnauthorized&&o("/login")}})();return()=>{c==null||c.then(p=>p==null?void 0:p.close())}},[e]),{ws:t}}const An=(e,t)=>{r.useEffect(()=>{(async()=>{try{(await fetch("http://localhost:8080/api/auth/verifyToken",{method:"POST",credentials:"include"})).ok?e(!0):t("/login")}catch(o){console.error("Failed to verify token",o),t("/login")}})()},[t,e])};function Wn(){const{selectedChannel:e,apiPing:t,isAuthenticated:n,setIsAuthenticated:o}=r.useContext(A),s=Ue();if(An(o,s),Ln({isAuthenticated:n}),!!n)return a.jsxs("div",{className:"d-flex vh-100",children:[a.jsx(On,{}),e?a.jsxs("div",{className:"card flex-grow-1 main-content",children:[a.jsx(Lt,{}),a.jsx(Bn,{})]}):a.jsxs("div",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center main-content",children:[a.jsx("h1",{children:"Welcome to Fidechat"}),t!==null&&a.jsxs("h3",{children:["API Ping & DB: ",t," ms"]})]})]})}export{Wn as default};
