import{r as a,G as B,j as r,c as Et,a as Rt,u as Ue,g as bt,A as Nt}from"./index-C9TKiR0q.js";import{c as ne,o as we,s as te,g as wt,R as kt,l as Be,i as Tt,u as j,a as y,b as be,C as Ft,d as Mt,e as St,f as Ot,r as Ie,F as ze,h as $t,t as At,P as X,j as Xe,k as qe}from"./CloseButton-Dk6N_CPr.js";function Lt(){const{selectedChannel:e}=a.useContext(B);return e?r.jsxs("header",{className:"channel-header d-flex justify-content-between",children:[r.jsx("h3",{className:"channel-title",children:"# "+e.name}),r.jsx("aside",{className:"channel-description mb-0",children:e.description})]}):null}var ue;function De(e){if((!ue&&ue!==0||e)&&ne){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),ue=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return ue}function Bt(){return a.useState(null)}function je(e){e===void 0&&(e=we());try{var t=e.activeElement;return!t||!t.nodeName?null:t}catch{return e.body}}function We(e,t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return e===t||!!(e.compareDocumentPosition(t)&16)}function It(){const e=a.useRef(!0),t=a.useRef(()=>e.current);return a.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function Dt(e){const t=a.useRef(e);return t.current=e,t}function Wt(e){const t=Dt(e);a.useEffect(()=>()=>t.current(),[])}function _t(e){const t=a.useRef(null);return a.useEffect(()=>{t.current=e}),t.current}function Ht(e){const t=a.useRef(e);return a.useEffect(()=>{t.current=e},[e]),t}function L(e){const t=Ht(e);return a.useCallback(function(...n){return t.current&&t.current(...n)},[t])}const Vt="data-rr-ui-";function Gt(e){return`${Vt}${e}`}function Kt(e=document){const t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}const _e=Gt("modal-open");class ke{constructor({ownerDocument:t,handleContainerOverflow:n=!0,isRTL:s=!1}={}){this.handleContainerOverflow=n,this.isRTL=s,this.modals=[],this.ownerDocument=t}getScrollbarWidth(){return Kt(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(t){}removeModalAttributes(t){}setContainerStyle(t){const n={overflow:"hidden"},s=this.isRTL?"paddingLeft":"paddingRight",o=this.getElement();t.style={overflow:o.style.overflow,[s]:o.style[s]},t.scrollBarWidth&&(n[s]=`${parseInt(te(o,s)||"0",10)+t.scrollBarWidth}px`),o.setAttribute(_e,""),te(o,n)}reset(){[...this.modals].forEach(t=>this.remove(t))}removeContainerStyle(t){const n=this.getElement();n.removeAttribute(_e),Object.assign(n.style,t.style)}add(t){let n=this.modals.indexOf(t);return n!==-1||(n=this.modals.length,this.modals.push(t),this.setModalAttributes(t),n!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),n}remove(t){const n=this.modals.indexOf(t);n!==-1&&(this.modals.splice(n,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(t))}isTopModal(t){return!!this.modals.length&&this.modals[this.modals.length-1]===t}}const Ye=a.createContext(ne?window:void 0);Ye.Provider;function Te(){return a.useContext(Ye)}const ve=(e,t)=>ne?e==null?(t||we()).body:(typeof e=="function"&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;function Ut(e,t){const n=Te(),[s,o]=a.useState(()=>ve(e,n==null?void 0:n.document));if(!s){const l=ve(e);l&&o(l)}return a.useEffect(()=>{},[t,s]),a.useEffect(()=>{const l=ve(e);l!==s&&o(l)},[e,s]),s}const He=e=>!e||typeof e=="function"?e:t=>{e.current=t};function zt(e,t){const n=He(e),s=He(t);return o=>{n&&n(o),s&&s(o)}}function Fe(e,t){return a.useMemo(()=>zt(e,t),[e,t])}const Xt=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",qt=typeof document<"u",Ve=qt||Xt?a.useLayoutEffect:a.useEffect;function Yt({children:e,in:t,onExited:n,mountOnEnter:s,unmountOnExit:o}){const l=a.useRef(null),i=a.useRef(t),u=L(n);a.useEffect(()=>{t?i.current=!0:u(l.current)},[t,u]);const f=Fe(l,e.ref),d=a.cloneElement(e,{ref:f});return t?d:o||!i.current&&s?null:d}const Jt=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function Qt(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function Zt(e){let{onEnter:t,onEntering:n,onEntered:s,onExit:o,onExiting:l,onExited:i,addEndListener:u,children:f}=e,d=Qt(e,Jt);const m=a.useRef(null),h=Fe(m,wt(f)),c=R=>k=>{R&&m.current&&R(m.current,k)},p=a.useCallback(c(t),[t]),C=a.useCallback(c(n),[n]),v=a.useCallback(c(s),[s]),w=a.useCallback(c(o),[o]),b=a.useCallback(c(l),[l]),$=a.useCallback(c(i),[i]),M=a.useCallback(c(u),[u]);return Object.assign({},d,{nodeRef:m},t&&{onEnter:p},n&&{onEntering:C},s&&{onEntered:v},o&&{onExit:w},l&&{onExiting:b},i&&{onExited:$},u&&{addEndListener:M},{children:typeof f=="function"?(R,k)=>f(R,Object.assign({},k,{ref:h})):a.cloneElement(f,{ref:h})})}const Pt=["component"];function en(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}const tn=a.forwardRef((e,t)=>{let{component:n}=e,s=en(e,Pt);const o=Zt(s);return r.jsx(n,Object.assign({ref:t},o))});function nn({in:e,onTransition:t}){const n=a.useRef(null),s=a.useRef(!0),o=L(t);return Ve(()=>{if(!n.current)return;let l=!1;return o({in:e,element:n.current,initial:s.current,isStale:()=>l}),()=>{l=!0}},[e,o]),Ve(()=>(s.current=!1,()=>{s.current=!0}),[]),n}function sn({children:e,in:t,onExited:n,onEntered:s,transition:o}){const[l,i]=a.useState(!t);t&&l&&i(!1);const u=nn({in:!!t,onTransition:d=>{const m=()=>{d.isStale()||(d.in?s==null||s(d.element,d.initial):(i(!0),n==null||n(d.element)))};Promise.resolve(o(d)).then(m,h=>{throw d.in||i(!0),h})}}),f=Fe(u,e.ref);return l&&!t?null:a.cloneElement(e,{ref:f})}function Ge(e,t,n){return e?r.jsx(tn,Object.assign({},n,{component:e})):t?r.jsx(sn,Object.assign({},n,{transition:t})):r.jsx(Yt,Object.assign({},n))}const on=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function an(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}let Ee;function rn(e){return Ee||(Ee=new ke({ownerDocument:e==null?void 0:e.document})),Ee}function ln(e){const t=Te(),n=e||rn(t),s=a.useRef({dialog:null,backdrop:null});return Object.assign(s.current,{add:()=>n.add(s.current),remove:()=>n.remove(s.current),isTopModal:()=>n.isTopModal(s.current),setDialogRef:a.useCallback(o=>{s.current.dialog=o},[]),setBackdropRef:a.useCallback(o=>{s.current.backdrop=o},[])})}const Je=a.forwardRef((e,t)=>{let{show:n=!1,role:s="dialog",className:o,style:l,children:i,backdrop:u=!0,keyboard:f=!0,onBackdropClick:d,onEscapeKeyDown:m,transition:h,runTransition:c,backdropTransition:p,runBackdropTransition:C,autoFocus:v=!0,enforceFocus:w=!0,restoreFocus:b=!0,restoreFocusOptions:$,renderDialog:M,renderBackdrop:R=x=>r.jsx("div",Object.assign({},x)),manager:k,container:I,onShow:D,onHide:q=()=>{},onExit:pe,onExited:Y,onExiting:se,onEnter:oe,onEntering:ae,onEntered:re}=e,ge=an(e,on);const S=Te(),W=Ut(I),E=ln(k),ye=It(),le=_t(n),[A,_]=a.useState(!n),N=a.useRef(null);a.useImperativeHandle(t,()=>E,[E]),ne&&!le&&n&&(N.current=je(S==null?void 0:S.document)),n&&A&&_(!1);const O=L(()=>{if(E.add(),H.current=Be(document,"keydown",Ce),Q.current=Be(document,"focus",()=>setTimeout(xe),!0),D&&D(),v){var x,de;const P=je((x=(de=E.dialog)==null?void 0:de.ownerDocument)!=null?x:S==null?void 0:S.document);E.dialog&&P&&!We(E.dialog,P)&&(N.current=P,E.dialog.focus())}}),J=L(()=>{if(E.remove(),H.current==null||H.current(),Q.current==null||Q.current(),b){var x;(x=N.current)==null||x.focus==null||x.focus($),N.current=null}});a.useEffect(()=>{!n||!W||O()},[n,W,O]),a.useEffect(()=>{A&&J()},[A,J]),Wt(()=>{J()});const xe=L(()=>{if(!w||!ye()||!E.isTopModal())return;const x=je(S==null?void 0:S.document);E.dialog&&x&&!We(E.dialog,x)&&E.dialog.focus()}),ie=L(x=>{x.target===x.currentTarget&&(d==null||d(x),u===!0&&q())}),Ce=L(x=>{f&&Tt(x)&&E.isTopModal()&&(m==null||m(x),x.defaultPrevented||q())}),Q=a.useRef(),H=a.useRef(),ce=(...x)=>{_(!0),Y==null||Y(...x)};if(!W)return null;const V=Object.assign({role:s,ref:E.setDialogRef,"aria-modal":s==="dialog"?!0:void 0},ge,{style:l,className:o,tabIndex:-1});let Z=M?M(V):r.jsx("div",Object.assign({},V,{children:a.cloneElement(i,{role:"document"})}));Z=Ge(h,c,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:pe,onExiting:se,onExited:ce,onEnter:oe,onEntering:ae,onEntered:re,children:Z});let G=null;return u&&(G=R({ref:E.setBackdropRef,onClick:ie}),G=Ge(p,C,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:G})),r.jsx(r.Fragment,{children:kt.createPortal(r.jsxs(r.Fragment,{children:[G,Z]}),W)})});Je.displayName="Modal";const cn=Object.assign(Je,{Manager:ke});function dn(e,t){return e.classList?e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}function un(e,t){e.classList?e.classList.add(t):dn(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}var fn=Function.prototype.bind.call(Function.prototype.call,[].slice);function U(e,t){return fn(e.querySelectorAll(t))}function Ke(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function mn(e,t){e.classList?e.classList.remove(t):typeof e.className=="string"?e.className=Ke(e.className,t):e.setAttribute("class",Ke(e.className&&e.className.baseVal||"",t))}const z={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class hn extends ke{adjustAndStore(t,n,s){const o=n.style[t];n.dataset[t]=o,te(n,{[t]:`${parseFloat(te(n,t))+s}px`})}restore(t,n){const s=n.dataset[t];s!==void 0&&(delete n.dataset[t],te(n,{[t]:s}))}setContainerStyle(t){super.setContainerStyle(t);const n=this.getElement();if(un(n,"modal-open"),!t.scrollBarWidth)return;const s=this.isRTL?"paddingLeft":"paddingRight",o=this.isRTL?"marginLeft":"marginRight";U(n,z.FIXED_CONTENT).forEach(l=>this.adjustAndStore(s,l,t.scrollBarWidth)),U(n,z.STICKY_CONTENT).forEach(l=>this.adjustAndStore(o,l,-t.scrollBarWidth)),U(n,z.NAVBAR_TOGGLER).forEach(l=>this.adjustAndStore(o,l,t.scrollBarWidth))}removeContainerStyle(t){super.removeContainerStyle(t);const n=this.getElement();mn(n,"modal-open");const s=this.isRTL?"paddingLeft":"paddingRight",o=this.isRTL?"marginLeft":"marginRight";U(n,z.FIXED_CONTENT).forEach(l=>this.restore(s,l)),U(n,z.STICKY_CONTENT).forEach(l=>this.restore(o,l)),U(n,z.NAVBAR_TOGGLER).forEach(l=>this.restore(o,l))}}let Re;function pn(e){return Re||(Re=new hn(e)),Re}const Qe=a.forwardRef(({className:e,bsPrefix:t,as:n="div",...s},o)=>(t=j(t,"modal-body"),r.jsx(n,{ref:o,className:y(e,t),...s})));Qe.displayName="ModalBody";const Ze=a.createContext({onHide(){}}),Me=a.forwardRef(({bsPrefix:e,className:t,contentClassName:n,centered:s,size:o,fullscreen:l,children:i,scrollable:u,...f},d)=>{e=j(e,"modal");const m=`${e}-dialog`,h=typeof l=="string"?`${e}-fullscreen-${l}`:`${e}-fullscreen`;return r.jsx("div",{...f,ref:d,className:y(m,t,o&&`${e}-${o}`,s&&`${m}-centered`,u&&`${m}-scrollable`,l&&h),children:r.jsx("div",{className:y(`${e}-content`,n),children:i})})});Me.displayName="ModalDialog";const Pe=a.forwardRef(({className:e,bsPrefix:t,as:n="div",...s},o)=>(t=j(t,"modal-footer"),r.jsx(n,{ref:o,className:y(e,t),...s})));Pe.displayName="ModalFooter";const gn=a.forwardRef(({closeLabel:e="Close",closeVariant:t,closeButton:n=!1,onHide:s,children:o,...l},i)=>{const u=a.useContext(Ze),f=be(()=>{u==null||u.onHide(),s==null||s()});return r.jsxs("div",{ref:i,...l,children:[o,n&&r.jsx(Ft,{"aria-label":e,variant:t,onClick:f})]})}),et=a.forwardRef(({bsPrefix:e,className:t,closeLabel:n="Close",closeButton:s=!1,...o},l)=>(e=j(e,"modal-header"),r.jsx(gn,{ref:l,...o,className:y(t,e),closeLabel:n,closeButton:s})));et.displayName="ModalHeader";const yn=e=>a.forwardRef((t,n)=>r.jsx("div",{...t,ref:n,className:y(t.className,e)})),xn=yn("h4"),tt=a.forwardRef(({className:e,bsPrefix:t,as:n=xn,...s},o)=>(t=j(t,"modal-title"),r.jsx(n,{ref:o,className:y(e,t),...s})));tt.displayName="ModalTitle";function Cn(e){return r.jsx(ze,{...e,timeout:null})}function jn(e){return r.jsx(ze,{...e,timeout:null})}const nt=a.forwardRef(({bsPrefix:e,className:t,style:n,dialogClassName:s,contentClassName:o,children:l,dialogAs:i=Me,"data-bs-theme":u,"aria-labelledby":f,"aria-describedby":d,"aria-label":m,show:h=!1,animation:c=!0,backdrop:p=!0,keyboard:C=!0,onEscapeKeyDown:v,onShow:w,onHide:b,container:$,autoFocus:M=!0,enforceFocus:R=!0,restoreFocus:k=!0,restoreFocusOptions:I,onEntered:D,onExit:q,onExiting:pe,onEnter:Y,onEntering:se,onExited:oe,backdropClassName:ae,manager:re,...ge},S)=>{const[W,E]=a.useState({}),[ye,le]=a.useState(!1),A=a.useRef(!1),_=a.useRef(!1),N=a.useRef(null),[O,J]=Bt(),xe=Mt(S,J),ie=be(b),Ce=St();e=j(e,"modal");const Q=a.useMemo(()=>({onHide:ie}),[ie]);function H(){return re||pn({isRTL:Ce})}function ce(g){if(!ne)return;const K=H().getScrollbarWidth()>0,Le=g.scrollHeight>we(g).documentElement.clientHeight;E({paddingRight:K&&!Le?De():void 0,paddingLeft:!K&&Le?De():void 0})}const V=be(()=>{O&&ce(O.dialog)});Ot(()=>{Ie(window,"resize",V),N.current==null||N.current()});const Z=()=>{A.current=!0},G=g=>{A.current&&O&&g.target===O.dialog&&(_.current=!0),A.current=!1},x=()=>{le(!0),N.current=At(O.dialog,()=>{le(!1)})},de=g=>{g.target===g.currentTarget&&x()},P=g=>{if(p==="static"){de(g);return}if(_.current||g.target!==g.currentTarget){_.current=!1;return}b==null||b()},pt=g=>{C?v==null||v(g):(g.preventDefault(),p==="static"&&x())},gt=(g,K)=>{g&&ce(g),Y==null||Y(g,K)},yt=g=>{N.current==null||N.current(),q==null||q(g)},xt=(g,K)=>{se==null||se(g,K),$t(window,"resize",V)},Ct=g=>{g&&(g.style.display=""),oe==null||oe(g),Ie(window,"resize",V)},jt=a.useCallback(g=>r.jsx("div",{...g,className:y(`${e}-backdrop`,ae,!c&&"show")}),[c,ae,e]),Ae={...n,...W};Ae.display="block";const vt=g=>r.jsx("div",{role:"dialog",...g,style:Ae,className:y(t,e,ye&&`${e}-static`,!c&&"show"),onClick:p?P:void 0,onMouseUp:G,"data-bs-theme":u,"aria-label":m,"aria-labelledby":f,"aria-describedby":d,children:r.jsx(i,{...ge,onMouseDown:Z,className:s,contentClassName:o,children:l})});return r.jsx(Ze.Provider,{value:Q,children:r.jsx(cn,{show:h,ref:xe,backdrop:p,container:$,keyboard:!0,autoFocus:M,enforceFocus:R,restoreFocus:k,restoreFocusOptions:I,onEscapeKeyDown:pt,onShow:w,onHide:b,onEnter:gt,onEntering:xt,onEntered:D,onExit:yt,onExiting:pe,onExited:Ct,manager:H(),transition:c?Cn:void 0,backdropTransition:c?jn:void 0,renderBackdrop:jt,renderDialog:vt})})});nt.displayName="Modal";const ee=Object.assign(nt,{Body:Qe,Header:et,Title:tt,Footer:Pe,Dialog:Me,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),vn=["as","disabled"];function En(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function Rn(e){return!e||e.trim()==="#"}function st({tagName:e,disabled:t,href:n,target:s,rel:o,role:l,onClick:i,tabIndex:u=0,type:f}){e||(n!=null||s!=null||o!=null?e="a":e="button");const d={tagName:e};if(e==="button")return[{type:f||"button",disabled:t},d];const m=c=>{if((t||e==="a"&&Rn(n))&&c.preventDefault(),t){c.stopPropagation();return}i==null||i(c)},h=c=>{c.key===" "&&(c.preventDefault(),m(c))};return e==="a"&&(n||(n="#"),t&&(n=void 0)),[{role:l??"button",disabled:void 0,tabIndex:t?void 0:u,href:n,target:e==="a"?s:void 0,"aria-disabled":t||void 0,rel:e==="a"?o:void 0,onClick:m,onKeyDown:h},d]}const bn=a.forwardRef((e,t)=>{let{as:n,disabled:s}=e,o=En(e,vn);const[l,{tagName:i}]=st(Object.assign({tagName:n,disabled:s},o));return r.jsx(i,Object.assign({},o,l,{ref:t}))});bn.displayName="Button";const Ne=a.forwardRef(({as:e,bsPrefix:t,variant:n="primary",size:s,active:o=!1,disabled:l=!1,className:i,...u},f)=>{const d=j(t,"btn"),[m,{tagName:h}]=st({tagName:e,disabled:l,...u}),c=h;return r.jsx(c,{...m,...u,ref:f,disabled:l,className:y(i,d,o&&"active",n&&`${d}-${n}`,s&&`${d}-${s}`,u.href&&l&&"disabled")})});Ne.displayName="Button";const Nn={type:X.string,tooltip:X.bool,as:X.elementType},he=a.forwardRef(({as:e="div",className:t,type:n="valid",tooltip:s=!1,...o},l)=>r.jsx(e,{...o,ref:l,className:y(t,`${n}-${s?"tooltip":"feedback"}`)}));he.displayName="Feedback";he.propTypes=Nn;const F=a.createContext({}),Se=a.forwardRef(({id:e,bsPrefix:t,className:n,type:s="checkbox",isValid:o=!1,isInvalid:l=!1,as:i="input",...u},f)=>{const{controlId:d}=a.useContext(F);return t=j(t,"form-check-input"),r.jsx(i,{...u,ref:f,type:s,id:e||d,className:y(n,t,o&&"is-valid",l&&"is-invalid")})});Se.displayName="FormCheckInput";const fe=a.forwardRef(({bsPrefix:e,className:t,htmlFor:n,...s},o)=>{const{controlId:l}=a.useContext(F);return e=j(e,"form-check-label"),r.jsx("label",{...s,ref:o,htmlFor:n||l,className:y(t,e)})});fe.displayName="FormCheckLabel";function wn(e,t){return a.Children.toArray(e).some(n=>a.isValidElement(n)&&n.type===t)}const ot=a.forwardRef(({id:e,bsPrefix:t,bsSwitchPrefix:n,inline:s=!1,reverse:o=!1,disabled:l=!1,isValid:i=!1,isInvalid:u=!1,feedbackTooltip:f=!1,feedback:d,feedbackType:m,className:h,style:c,title:p="",type:C="checkbox",label:v,children:w,as:b="input",...$},M)=>{t=j(t,"form-check"),n=j(n,"form-switch");const{controlId:R}=a.useContext(F),k=a.useMemo(()=>({controlId:e||R}),[R,e]),I=!w&&v!=null&&v!==!1||wn(w,fe),D=r.jsx(Se,{...$,type:C==="switch"?"checkbox":C,ref:M,isValid:i,isInvalid:u,disabled:l,as:b});return r.jsx(F.Provider,{value:k,children:r.jsx("div",{style:c,className:y(h,I&&t,s&&`${t}-inline`,o&&`${t}-reverse`,C==="switch"&&n),children:w||r.jsxs(r.Fragment,{children:[D,I&&r.jsx(fe,{title:p,children:v}),d&&r.jsx(he,{type:m,tooltip:f,children:d})]})})})});ot.displayName="FormCheck";const me=Object.assign(ot,{Input:Se,Label:fe}),at=a.forwardRef(({bsPrefix:e,type:t,size:n,htmlSize:s,id:o,className:l,isValid:i=!1,isInvalid:u=!1,plaintext:f,readOnly:d,as:m="input",...h},c)=>{const{controlId:p}=a.useContext(F);return e=j(e,"form-control"),r.jsx(m,{...h,type:t,size:s,ref:c,readOnly:d,id:o||p,className:y(l,f?`${e}-plaintext`:e,n&&`${e}-${n}`,t==="color"&&`${e}-color`,i&&"is-valid",u&&"is-invalid")})});at.displayName="FormControl";const kn=Object.assign(at,{Feedback:he}),rt=a.forwardRef(({className:e,bsPrefix:t,as:n="div",...s},o)=>(t=j(t,"form-floating"),r.jsx(n,{ref:o,className:y(e,t),...s})));rt.displayName="FormFloating";const Oe=a.forwardRef(({controlId:e,as:t="div",...n},s)=>{const o=a.useMemo(()=>({controlId:e}),[e]);return r.jsx(F.Provider,{value:o,children:r.jsx(t,{...n,ref:s})})});Oe.displayName="FormGroup";function Tn({as:e,bsPrefix:t,className:n,...s}){t=j(t,"col");const o=Xe(),l=qe(),i=[],u=[];return o.forEach(f=>{const d=s[f];delete s[f];let m,h,c;typeof d=="object"&&d!=null?{span:m,offset:h,order:c}=d:m=d;const p=f!==l?`-${f}`:"";m&&i.push(m===!0?`${t}${p}`:`${t}${p}-${m}`),c!=null&&u.push(`order${p}-${c}`),h!=null&&u.push(`offset${p}-${h}`)}),[{...s,className:y(n,...i,...u)},{as:e,bsPrefix:t,spans:i}]}const lt=a.forwardRef((e,t)=>{const[{className:n,...s},{as:o="div",bsPrefix:l,spans:i}]=Tn(e);return r.jsx(o,{...s,ref:t,className:y(n,!i.length&&l)})});lt.displayName="Col";const it=a.forwardRef(({as:e="label",bsPrefix:t,column:n=!1,visuallyHidden:s=!1,className:o,htmlFor:l,...i},u)=>{const{controlId:f}=a.useContext(F);t=j(t,"form-label");let d="col-form-label";typeof n=="string"&&(d=`${d} ${d}-${n}`);const m=y(o,t,s&&"visually-hidden",n&&d);return l=l||f,n?r.jsx(lt,{ref:u,as:"label",className:m,htmlFor:l,...i}):r.jsx(e,{ref:u,className:m,htmlFor:l,...i})});it.displayName="FormLabel";const ct=a.forwardRef(({bsPrefix:e,className:t,id:n,...s},o)=>{const{controlId:l}=a.useContext(F);return e=j(e,"form-range"),r.jsx("input",{...s,type:"range",ref:o,className:y(t,e),id:n||l})});ct.displayName="FormRange";const dt=a.forwardRef(({bsPrefix:e,size:t,htmlSize:n,className:s,isValid:o=!1,isInvalid:l=!1,id:i,...u},f)=>{const{controlId:d}=a.useContext(F);return e=j(e,"form-select"),r.jsx("select",{...u,size:n,ref:f,className:y(s,e,t&&`${e}-${t}`,o&&"is-valid",l&&"is-invalid"),id:i||d})});dt.displayName="FormSelect";const ut=a.forwardRef(({bsPrefix:e,className:t,as:n="small",muted:s,...o},l)=>(e=j(e,"form-text"),r.jsx(n,{...o,ref:l,className:y(t,e,s&&"text-muted")})));ut.displayName="FormText";const ft=a.forwardRef((e,t)=>r.jsx(me,{...e,ref:t,type:"switch"}));ft.displayName="Switch";const Fn=Object.assign(ft,{Input:me.Input,Label:me.Label}),mt=a.forwardRef(({bsPrefix:e,className:t,children:n,controlId:s,label:o,...l},i)=>(e=j(e,"form-floating"),r.jsxs(Oe,{ref:i,className:y(t,e),controlId:s,...l,children:[n,r.jsx("label",{htmlFor:s,children:o})]})));mt.displayName="FloatingLabel";const Mn={_ref:X.any,validated:X.bool,as:X.elementType},$e=a.forwardRef(({className:e,validated:t,as:n="form",...s},o)=>r.jsx(n,{...s,ref:o,className:y(e,t&&"was-validated")}));$e.displayName="Form";$e.propTypes=Mn;const T=Object.assign($e,{Group:Oe,Control:kn,Floating:rt,Check:me,Switch:Fn,Label:it,Text:ut,Range:ct,Select:dt,FloatingLabel:mt}),ht=a.forwardRef(({bsPrefix:e,className:t,as:n="div",...s},o)=>{const l=j(e,"row"),i=Xe(),u=qe(),f=`${l}-cols`,d=[];return i.forEach(m=>{const h=s[m];delete s[m];let c;h!=null&&typeof h=="object"?{cols:c}=h:c=h;const p=m!==u?`-${m}`:"";c!=null&&d.push(`${f}${p}-${c}`)}),r.jsx(n,{ref:o,...s,className:y(t,l,...d)})});ht.displayName="Row";function Sn({show:e,handleClose:t}){const[n,s]=a.useState(!1),[o,l]=a.useState(""),[i,u]=a.useState(""),{currentUser:f}=a.useContext(B);function d(h,c){Et({name:h,description:c,ownerId:f.id})}const m=h=>{h.preventDefault();const c=h.currentTarget;console.log(c.checkValidity()),c.checkValidity()===!1?(h.stopPropagation(),s(!0)):(d(o,i),t(),l(""),u(""))};return r.jsxs(ee,{show:e,onHide:t,children:[r.jsx(ee.Header,{closeButton:!0,children:r.jsx(ee.Title,{children:"Create Channel"})}),r.jsx(ee.Body,{children:r.jsx(T,{id:"createChannelForm",noValidate:!0,validated:n,onSubmit:m,children:r.jsxs(ht,{className:"mb-3",children:[r.jsxs(T.Group,{controlId:"channelName",children:[r.jsx(T.Label,{children:"Channel Name"}),r.jsx(T.Control,{type:"text",value:o,onChange:h=>l(h.target.value),required:!0}),r.jsx(T.Control.Feedback,{type:"invalid",children:"Please provide a valid channel name."})]}),r.jsxs(T.Group,{controlId:"channelDescription",children:[r.jsx(T.Label,{children:"Description"}),r.jsx(T.Control,{required:!0,as:"textarea",value:i,onChange:h=>u(h.target.value)}),r.jsx(T.Control.Feedback,{type:"invalid",children:"Please provide a valid description."})]})]})})}),r.jsxs(ee.Footer,{children:[r.jsx(Ne,{variant:"secondary",onClick:t,children:"Close"}),r.jsx(Ne,{variant:"primary",type:"submit",form:"createChannelForm",children:"Create Channel"})]})]})}function On(){console.log("Sidebar rendered");const[e,t]=a.useState(!1),{currentUser:n,setSelectedChannel:s,selectedChannel:o,channels:l}=a.useContext(B);return r.jsxs(r.Fragment,{children:[r.jsxs("nav",{className:"sidebar p-1",children:[r.jsx("h2",{className:"text-center",children:"Fidechat"}),r.jsx("h5",{className:"mt-4 ms-1",children:"Channels"}),r.jsx("ul",{className:"list-unstyled flex-grow-1 overflow-auto ms-1",children:l.map((i,u)=>r.jsx("li",{className:"mb-2",children:r.jsx("button",{className:`p-2 w-100 btn-channel text-left rounded ${(o==null?void 0:o.id)===i.id?"bg-secondary selected":"bg-body-secondary"}`,onClick:()=>{(o==null?void 0:o.id)===i.id?s(null):s(i)},onKeyUp:f=>{(f.key==="Enter"||f.key===" ")&&s(i)},children:i.name})},u))}),r.jsx("button",{className:"btn btn-secondary mb-3 btn-create-channel",onClick:()=>t(!0),children:"Create Channel"}),r.jsxs("div",{className:"mt-auto",children:[r.jsx("hr",{className:"bg-light"}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"mb-1",children:n==null?void 0:n.name}),r.jsx("small",{className:"text-muted",children:n==null?void 0:n.email})]})]})]}),r.jsx(Sn,{show:e,handleClose:()=>t(!1)})]})}const $n="/assets/avatar-BPXR60FK.png";function An({content:e,authorId:t,createdAt:n}){const{users:s,currentUser:o}=a.useContext(B);let l="";if((o==null?void 0:o.id)===t)l="You";else{const i=s.find(u=>u.id===t);l=i?i.name:"Unknown"}return r.jsxs("article",{className:"mb-3 pt-2 ps-2 rounded shadow bg-body-tertiary d-flex",children:[r.jsx("img",{src:$n,alt:l,className:"message-avatar"}),r.jsxs("div",{children:[r.jsxs("header",{children:[r.jsx("span",{className:"message-username",children:l}),r.jsx("span",{className:"message-timestamp",children:n.toLocaleTimeString()})]}),r.jsx("p",{className:"message-content",children:e})]})]})}function Ln(){console.log("Chat rendered");const[e,t]=a.useState(""),{selectedChannel:n,currentUser:s}=a.useContext(B),o=async()=>{if(e.length)try{const i={content:e,channelId:n.id,authorId:s.id,createdAt:new Date().toISOString()};Rt(i),t("")}catch(i){console.error(i)}},l=i=>{i.key==="Enter"&&o()};return r.jsxs("section",{className:"card-body d-flex flex-column p-0 mt-5",children:[r.jsx("div",{className:"flex-grow-1 overflow-auto p-3 bg-dark",children:n==null?void 0:n.messages.filter(i=>i.channelId===(n==null?void 0:n.id)).map(i=>r.jsx(An,{content:i.content,authorId:i.authorId,createdAt:new Date(i.createdAt)},i.id))}),r.jsxs("footer",{className:"card-footer d-flex p-3 bg-body-tertiary border-top sticky-bottom",children:[r.jsx("input",{type:"text",className:"form-control me-2",value:e,onChange:i=>t(i.target.value),placeholder:"Type a message...",onKeyDown:l}),r.jsx("button",{className:"btn btn-primary",onClick:o,children:"Send"})]})]})}function Bn({isAuthenticated:e}){const[t,n]=a.useState(null),s=Ue(),{setChannels:o,setSelectedChannel:l,channels:i,selectedChannel:u}=a.useContext(B),f=a.useRef(i),d=a.useRef(u);a.useEffect(()=>{f.current=i,d.current=u},[i,u]);const m=h=>{var p;console.log(f.current),console.log("Received message:",h.data);const c=JSON.parse(h.data);if(c.type==="MESSAGE_CREATE"){const C=f.current.find(v=>v.id==c.payload.channelId);if(!C){console.error("Channel not found: "+c.payload.channelId);return}o(f.current.map(v=>v.id===C.id?{...C,messages:[...C.messages,c.payload]}:v)),((p=d.current)==null?void 0:p.id)===C.id&&l({...C,messages:[...C.messages,c.payload]})}else c.type==="CHANNEL_CREATE"&&o([...f.current,{...c.payload,messages:[]}])};return a.useEffect(()=>{if(!e){t&&(t.close(),n(null));return}const c=(async()=>{try{const p=await bt();if(!p)return;if(t)return console.error("Websocket connection already exists"),t;const C=new WebSocket("ws://localhost:8080/ws?token="+p);return C.onopen=()=>console.log("Connected to websocket"),C.onmessage=m,C.onerror=v=>console.error(v),C.onclose=()=>console.log("Disconnected from websocket"),C}catch(p){console.error(p),p instanceof Nt&&p.isUnauthorized&&s("/login")}})();return()=>{c==null||c.then(p=>p==null?void 0:p.close())}},[e]),{ws:t}}const In=(e,t)=>{a.useEffect(()=>{(async()=>{try{(await fetch("http://localhost:8080/api/auth/verifyToken",{method:"POST",credentials:"include"})).ok?e(!0):t("/login")}catch(s){console.error("Failed to verify token",s),t("/login")}})()},[t,e])};function _n(){const{selectedChannel:e,apiPing:t,isAuthenticated:n,setIsAuthenticated:s}=a.useContext(B),o=Ue();if(In(s,o),Bn({isAuthenticated:n}),!!n)return r.jsxs("div",{className:"d-flex vh-100",children:[r.jsx(On,{}),e?r.jsxs("main",{className:"card flex-grow-1 main-content",children:[r.jsx(Lt,{}),r.jsx(Ln,{})]}):r.jsxs("main",{className:"flex-grow-1 d-flex flex-column justify-content-center align-items-center main-content",children:[r.jsx("h1",{children:"Welcome to Fidechat"}),t!==null&&r.jsxs("h3",{children:["API Ping & DB: ",t," ms"]})]})]})}export{_n as default};
